# æ»´ç­”æ¸…å•APIé›†æˆé…ç½®æŒ‡å—

## ğŸ¯ åŠŸèƒ½æ¦‚è¿°

ArXiv Follow ç³»ç»Ÿå·²é›†æˆæ»´ç­”æ¸…å•APIï¼Œå¯ä»¥åœ¨æ¯æ¬¡æ‰§è¡Œè®ºæ–‡ç›‘æ§ä»»åŠ¡åè‡ªåŠ¨åˆ›å»ºæ»´ç­”æ¸…å•ä»»åŠ¡ï¼Œæ–¹ä¾¿ä½ è·Ÿè¸ªå’Œç®¡ç†è®ºæ–‡ç›‘æ§ç»“æœã€‚

### æ”¯æŒçš„åŠŸèƒ½
- âœ… **æ¯æ—¥è®ºæ–‡ç›‘æ§** - åˆ›å»ºæ¯æ—¥å‘ç°è®ºæ–‡çš„æ±‡æ€»ä»»åŠ¡
- âœ… **å‘¨æŠ¥è®ºæ–‡æ±‡æ€»** - åˆ›å»ºæ¯å‘¨è®ºæ–‡ç›‘æ§æŠ¥å‘Šä»»åŠ¡
- âœ… **ä¸»é¢˜è®ºæ–‡æœç´¢** - åˆ›å»ºåŸºäºä¸»é¢˜æœç´¢çš„è®ºæ–‡å‘ç°ä»»åŠ¡
- âœ… **é”™è¯¯ç›‘æ§** - å½“ç›‘æ§è„šæœ¬å‡ºé”™æ—¶åˆ›å»ºé”™è¯¯è®°å½•ä»»åŠ¡
- âœ… **æ™ºèƒ½ä¼˜å…ˆçº§** - æ ¹æ®å‘ç°è®ºæ–‡æ•°é‡è‡ªåŠ¨è®¾ç½®ä»»åŠ¡ä¼˜å…ˆçº§

## ğŸ”‘ è·å–æ»´ç­”æ¸…å• Access Token

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨ç¬¬ä¸‰æ–¹å·¥å…·ï¼ˆæ¨èï¼‰

æ ¹æ®ç”¨æˆ·åˆ†äº«ï¼Œå¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹å¼€å‘çš„è·å–å·¥å…·ï¼š

1. **è®¿é—®è·å–å·¥å…·**ï¼š
   - åœ¨çº¿å·¥å…·ï¼šhttps://dida-auth.vercel.app/
   - GitHubé¡¹ç›®ï¼šhttps://github.com/Stream-L/dida-auth

2. **æ“ä½œæ­¥éª¤**ï¼š
   - åœ¨ [æ»´ç­”æ¸…å•å¼€å‘è€…ç®¡ç†é¡µé¢](https://developer.dida365.com/manage) åˆ›å»ºæ–°åº”ç”¨
   - è·å– Client ID å’Œ Client Secret
   - åœ¨å·¥å…·é¡µé¢è¾“å…¥Client IDå’ŒClient Secret
   - å¤åˆ¶ç”Ÿæˆçš„ Redirect URI åˆ°æ»´ç­”æ¸…å•åº”ç”¨è®¾ç½®ä¸­
   - ç‚¹å‡»"Get Authorization Code"è¿›è¡Œæˆæƒ
   - ç‚¹å‡»"Get Access Token"è·å–è®¿é—®ä»¤ç‰Œ

### æ–¹æ³•äºŒï¼šæŸ¥çœ‹æ»´ç­”æ¸…å•å®˜æ–¹APIæ–‡æ¡£

è®¿é—® [æ»´ç­”æ¸…å•å¼€å‘è€…APIæ–‡æ¡£](https://developer.dida365.com/api) äº†è§£OAuth2è®¤è¯æµç¨‹ã€‚

## âš™ï¸ é…ç½® Access Token

### æœ¬åœ°å¼€å‘ç¯å¢ƒ

1. **è®¾ç½®ç¯å¢ƒå˜é‡**ï¼š
```bash
# Windows (CMD)
set DIDA_ACCESS_TOKEN=your_access_token_here

# Windows (PowerShell)
$env:DIDA_ACCESS_TOKEN="your_access_token_here"

# macOS/Linux
export DIDA_ACCESS_TOKEN="your_access_token_here"
```

2. **æµ‹è¯•è¿æ¥**ï¼š
```bash
# æµ‹è¯•æ»´ç­”æ¸…å•APIé›†æˆ
uv run python test_dida_integration.py

# ç›´æ¥æµ‹è¯•è¿æ¥
uv run python dida_integration.py
```

### GitHub Actions (CI/CD)

1. **æ·»åŠ  GitHub Secret**ï¼š
   - è¿›å…¥ä½ çš„GitHubä»“åº“
   - ç‚¹å‡» `Settings` â†’ `Secrets and variables` â†’ `Actions`
   - ç‚¹å‡» `New repository secret`
   - Name: `DIDA_ACCESS_TOKEN`
   - Secret: ä½ çš„æ»´ç­”æ¸…å•access token
   - ç‚¹å‡» `Add secret`

2. **GitHub Actionsä¸­çš„é…ç½®**ï¼š
GitHub Actionså·¥ä½œæµå·²è‡ªåŠ¨é…ç½®å¥½ç¯å¢ƒå˜é‡ï¼Œæ— éœ€é¢å¤–ä¿®æ”¹ã€‚

## ğŸš€ ä½¿ç”¨æ–¹å¼

### è‡ªåŠ¨é›†æˆ

æ‰€æœ‰ä¸»è¦è„šæœ¬éƒ½å·²é›†æˆæ»´ç­”æ¸…å•åŠŸèƒ½ï¼Œæ— éœ€é¢å¤–é…ç½®ï¼š

- `daily_papers.py` - æ¯æ—¥ç›‘æ§åè‡ªåŠ¨åˆ›å»ºä»»åŠ¡
- `weekly_papers.py` - å‘¨æŠ¥ç”Ÿæˆåè‡ªåŠ¨åˆ›å»ºä»»åŠ¡  
- `topic_papers.py` - ä¸»é¢˜æœç´¢åè‡ªåŠ¨åˆ›å»ºä»»åŠ¡

### æ‰‹åŠ¨æµ‹è¯•

```bash
# æµ‹è¯•APIè¿æ¥å’Œä»»åŠ¡åˆ›å»º
uv run python test_dida_integration.py

# è¿è¡Œæ¯æ—¥ç›‘æ§ï¼ˆä¼šè‡ªåŠ¨åˆ›å»ºæ»´ç­”æ¸…å•ä»»åŠ¡ï¼‰
uv run python daily_papers.py

# è¿è¡Œå‘¨æŠ¥ç”Ÿæˆï¼ˆä¼šè‡ªåŠ¨åˆ›å»ºæ»´ç­”æ¸…å•ä»»åŠ¡ï¼‰
uv run python weekly_papers.py

# è¿è¡Œä¸»é¢˜æœç´¢ï¼ˆä¼šè‡ªåŠ¨åˆ›å»ºæ»´ç­”æ¸…å•ä»»åŠ¡ï¼‰
uv run python topic_papers.py
```

## ğŸ“‹ ä»»åŠ¡å†…å®¹è¯´æ˜

### ä»»åŠ¡æ ‡é¢˜æ ¼å¼
- ğŸ“„ æ¯æ—¥è®ºæ–‡ç›‘æ§ - YYYY-MM-DD
- ğŸ“š å‘¨æŠ¥è®ºæ–‡æ±‡æ€» - YYYY-MM-DD  
- ğŸ¯ ä¸»é¢˜è®ºæ–‡æœç´¢ - YYYY-MM-DD

### ä»»åŠ¡å†…å®¹åŒ…å«
- ğŸ“Š **ç»Ÿè®¡ä¿¡æ¯** - å‘ç°è®ºæ–‡æ•°é‡ã€ç›‘æ§ç ”ç©¶è€…æ•°é‡
- ğŸ“ **è¯¦ç»†ä¿¡æ¯** - è®ºæ–‡åˆ†å¸ƒã€ç ”ç©¶è€…è¯¦æƒ…ã€è®ºæ–‡æ ‡é¢˜æ‘˜è¦
- â° **æ‰§è¡Œæ—¶é—´** - ä»»åŠ¡æ‰§è¡Œçš„å…·ä½“æ—¶é—´
- ğŸ¤– **ç³»ç»Ÿæ ‡è¯†** - æ ‡æ³¨ä¸ºç”±ArXiv Followç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆ

### ä»»åŠ¡ä¼˜å…ˆçº§
- **æ— ä¼˜å…ˆçº§(0)** - æœªå‘ç°è®ºæ–‡æ—¶
- **ä¸­ç­‰ä¼˜å…ˆçº§(1)** - å‘ç°å°‘é‡è®ºæ–‡æ—¶(1-9ç¯‡)
- **é«˜ä¼˜å…ˆçº§(2)** - å‘ç°å¤§é‡è®ºæ–‡æ—¶(10+ç¯‡)

### ä»»åŠ¡æ ‡ç­¾
- `arxiv` - æ‰€æœ‰ArXivç›¸å…³ä»»åŠ¡
- `è®ºæ–‡ç›‘æ§` - ç›‘æ§ç±»å‹æ ‡è¯†
- `daily`/`weekly`/`topic` - å…·ä½“ä»»åŠ¡ç±»å‹

## ğŸ› ï¸ é…ç½®å®šåˆ¶

### ä¿®æ”¹é…ç½®

ç¼–è¾‘ `config.py` æ–‡ä»¶ä¸­çš„ `DIDA_API_CONFIG` éƒ¨åˆ†ï¼š

```python
DIDA_API_CONFIG = {
    # æ˜¯å¦å¯ç”¨æ»´ç­”æ¸…å•é›†æˆ
    "enabled": True,
    
    # é»˜è®¤é¡¹ç›®IDï¼ˆæ”¶é›†ç®±ï¼‰
    "default_project_id": "inbox",
    
    # ä»»åŠ¡æ ‡ç­¾å‰ç¼€
    "tag_prefix": "arxiv",
    
    # ä»»åŠ¡ä¼˜å…ˆçº§æ˜ å°„
    "priority_mapping": {
        "no_papers": 0,    # æ— è®ºæ–‡æ—¶ä¼˜å…ˆçº§
        "has_papers": 1,   # æœ‰è®ºæ–‡æ—¶ä¼˜å…ˆçº§
        "many_papers": 2   # è®ºæ–‡è¾ƒå¤šæ—¶ä¼˜å…ˆçº§ï¼ˆ>=10ç¯‡ï¼‰
    },
    
    # è®ºæ–‡æ•°é‡é˜ˆå€¼
    "many_papers_threshold": 10
}
```

### ç¦ç”¨é›†æˆ

å¦‚æœä¸æƒ³ä½¿ç”¨æ»´ç­”æ¸…å•é›†æˆï¼Œå¯ä»¥ï¼š

1. **åˆ é™¤ç¯å¢ƒå˜é‡**ï¼š
```bash
unset DIDA_ACCESS_TOKEN
```

2. **æˆ–ä¿®æ”¹é…ç½®**ï¼š
```python
DIDA_API_CONFIG = {
    "enabled": False,
    # ... å…¶ä»–é…ç½®
}
```

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **Tokenæ— æ•ˆæˆ–è¿‡æœŸ**
   - ç°è±¡ï¼šAPIè°ƒç”¨è¿”å›401é”™è¯¯
   - è§£å†³ï¼šé‡æ–°è·å–access token

2. **ç½‘ç»œè¿æ¥é—®é¢˜**
   - ç°è±¡ï¼šè¯·æ±‚è¶…æ—¶æˆ–è¿æ¥å¤±è´¥
   - è§£å†³ï¼šæ£€æŸ¥ç½‘ç»œè¿æ¥ï¼Œç¡®è®¤æ»´ç­”æ¸…å•æœåŠ¡å¯è®¿é—®

3. **ä»»åŠ¡åˆ›å»ºå¤±è´¥**
   - ç°è±¡ï¼šè¿”å›å…¶ä»–HTTPé”™è¯¯ç 
   - è§£å†³ï¼šæ£€æŸ¥tokenæƒé™ï¼ŒæŸ¥çœ‹é”™è¯¯è¯¦æƒ…

### è°ƒè¯•æ¨¡å¼

å¯ç”¨è¯¦ç»†æ—¥å¿—è¾“å‡ºï¼š

```python
import logging
logging.basicConfig(level=logging.DEBUG)
```

### éªŒè¯é…ç½®

è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶ï¼š

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
uv run python test_dida_integration.py

# æŸ¥çœ‹è¯¦ç»†è¾“å‡º
DIDA_ACCESS_TOKEN="your_token" uv run python test_dida_integration.py
```

## ğŸ“š APIå‚è€ƒ

### ä¸»è¦å‡½æ•°

```python
from dida_integration import create_arxiv_task, test_dida_connection

# æµ‹è¯•è¿æ¥
success = test_dida_connection()

# åˆ›å»ºä»»åŠ¡
result = create_arxiv_task(
    report_type="daily",  # daily/weekly/topic
    summary="ä»»åŠ¡æ‘˜è¦",
    details="è¯¦ç»†ä¿¡æ¯", 
    paper_count=5
)
```

### è¿”å›å€¼æ ¼å¼

```python
{
    "success": True,
    "task_id": "task_id_string",
    "title": "ä»»åŠ¡æ ‡é¢˜",
    "url": "https://dida365.com/webapp/#/task/task_id"
}
```

## ğŸ”— ç›¸å…³é“¾æ¥

- [æ»´ç­”æ¸…å•å®˜ç½‘](https://dida365.com/)
- [æ»´ç­”æ¸…å•å¼€å‘è€…æ–‡æ¡£](https://developer.dida365.com/api)
- [OAuth Tokenè·å–å·¥å…·](https://dida-auth.vercel.app/)
- [ArXiv Follow é¡¹ç›®ä¸»é¡µ](https://github.com/your-username/arxiv_follow)

## ğŸ’¡ æç¤º

- Access Tokenå»ºè®®å®šæœŸæ›´æ–°ä»¥ç¡®ä¿å®‰å…¨
- å¯ä»¥åœ¨æ»´ç­”æ¸…å•Webç‰ˆæˆ–Appä¸­æŸ¥çœ‹å’Œç®¡ç†è‡ªåŠ¨åˆ›å»ºçš„ä»»åŠ¡
- ä»»åŠ¡åˆ›å»ºå¤±è´¥ä¸ä¼šå½±å“è®ºæ–‡ç›‘æ§è„šæœ¬çš„æ­£å¸¸æ‰§è¡Œ
- å»ºè®®åœ¨æœ¬åœ°å…ˆæµ‹è¯•APIè¿æ¥ï¼Œç¡®è®¤æ— è¯¯åå†é…ç½®åˆ°GitHub Actionsä¸­ 